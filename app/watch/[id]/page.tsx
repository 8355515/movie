'use client'; import { useEffect, useState } from 'react'; import Layout from '../../../components/Layout'; import Player from '../../../components/Player'; export default function WatchPage({ params }: { params: { id: string } }) { const [progress, setProgress] = useState<number|null>(null); useEffect(()=>{ async function f(){ const res=await fetch('/api/progress'); const data=await res.json(); if(data[params.id]) setProgress(Number(data[params.id])); } f(); },[params.id]); return <Layout><div className="p-6 space-y-4"><h1 className="text-xl font-bold">正在播放: {params.id}</h1>{progress!==null && <div className="bg-yellow-500 text-black p-2 rounded">上次观看到 {progress}% <button className="underline ml-2" onClick={()=>{ const video=document.querySelector('video'); if(video) video.currentTime=(progress/100)*video.duration; }}>继续观看</button></div>}<Player id={params.id} src="https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8" /></div></Layout> }